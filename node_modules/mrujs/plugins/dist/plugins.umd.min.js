!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).mrujs={})}(this,(function(e){"use strict";function n(){const{script:e,any:n}=window.mrujs.mimeTypes;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${e}, ${n}`}])}function t(){document.addEventListener("ajax:complete",i)}function o(){document.removeEventListener("ajax:complete",i)}function i(e){var n,t,o,i,r;if(null==(r=null===(t=null===(n=e.detail)||void 0===n?void 0:n.fetchResponse)||void 0===t?void 0:t.contentType)||!Boolean(r.match(/\b(?:java|ecma)script\b/)))return;const s=document.createElement("script"),a=window.mrujs.cspNonce();null!=a&&s.setAttribute("nonce",a),window.mrujs.enableElement(e),null===(i=null===(o=e.detail)||void 0===o?void 0:o.fetchResponse)||void 0===i||i.text().then((n=>{var t,o;s.text=n,null===(o=null===(t=document.head.appendChild(s))||void 0===t?void 0:t.parentNode)||void 0===o||o.removeChild(s);const{element:i,fetchRequest:r,fetchResponse:a}=e.detail;window.mrujs.navigationAdapter.navigate(i,r,a)})).catch((e=>console.error(e)))}const r="text/vnd.turbo-stream.html";function s(){const e=window.mrujs.mimeTypes.any;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${r}, ${e}`},{shortcut:"turbo",header:r}])}function a(){document.addEventListener("ajax:beforeNavigation",d)}function c(){document.removeEventListener("ajax:beforeNavigation",d)}function d(e){const n=e.detail.fetchResponse;var t;null!=n&&(t=n.contentType,Boolean(t.includes(r))&&(e.preventDefault(),n.html().then((e=>{window.Turbo.renderStreamMessage(e)})).catch((e=>{console.error(e)}))))}function u(){document.addEventListener("sl-submit",m)}function l(){document.removeEventListener("sl-submit",m)}function m(e){var n,t,o;const i=e.target,r=e.detail.formData,s=i.getAttribute("action");let a=i.getAttribute("method");if(null==s)return void console.warn("No 'action' attribute on your Shoelace form. Aborting...");null==a&&(a="get");const c=()=>window.mrujs;null===(o=null===(t=null===(n=c())||void 0===n?void 0:n.fetch(s,{element:i,dispatchEvents:!0,method:a,body:c().urlEncodeFormData(r)}))||void 0===t?void 0:t.then((()=>{})))||void 0===o||o.catch((e=>console.warn(e)))}e.CableCar=class{constructor(e,{mimeType:n}={}){this.cableReady=e,this.mimeType=null!=n?n:"application/vnd.cable-ready.json",this.boundPerform=this.perform.bind(this)}get name(){return"CableCar"}initialize(){const e=window.mrujs.mimeTypes.any;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${this.mimeType}, ${e}`},{shortcut:"cablecar",header:this.mimeType}])}connect(){document.addEventListener("ajax:beforeNavigation",this.boundPerform)}disconnect(){document.removeEventListener("ajax:beforeNavigation",this.boundPerform)}perform(e){const n=e.detail.fetchResponse;null!=(null==n?void 0:n.contentType)&&this.isCableReadyResponse(n.contentType)&&(e.preventDefault(),n.json().then((e=>{this.cableReady.perform(e)})).catch((e=>{console.error(e)})))}isCableReadyResponse(e){return Boolean(e.includes(this.mimeType))}},e.JsErb=function(){return{name:"JsErb",initialize:n,connect:t,disconnect:o}},e.MrujsTurbo=function(){return{name:"MrujsTurbo",initialize:s,connect:a,disconnect:c}},e.Shoelace=function(){return{name:"Shoelace",connect:u,disconnect:l}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=plugins.umd.min.js.map
