class e{constructor(e,{mimeType:n}={}){this.cableReady=e,this.mimeType=null!=n?n:"application/vnd.cable-ready.json",this.boundPerform=this.perform.bind(this)}get name(){return"CableCar"}initialize(){const e=window.mrujs.mimeTypes.any;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${this.mimeType}, ${e}`},{shortcut:"cablecar",header:this.mimeType}])}connect(){document.addEventListener("ajax:beforeNavigation",this.boundPerform)}disconnect(){document.removeEventListener("ajax:beforeNavigation",this.boundPerform)}perform(e){const n=e.detail.fetchResponse;null!=(null==n?void 0:n.contentType)&&this.isCableReadyResponse(n.contentType)&&(e.preventDefault(),n.json().then((e=>{this.cableReady.perform(e)})).catch((e=>{console.error(e)})))}isCableReadyResponse(e){return Boolean(e.includes(this.mimeType))}}function n(){return{name:"JsErb",initialize:t,connect:o,disconnect:i}}function t(){const{script:e,any:n}=window.mrujs.mimeTypes;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${e}, ${n}`}])}function o(){document.addEventListener("ajax:complete",r)}function i(){document.removeEventListener("ajax:complete",r)}function r(e){var n,t,o,i,r;if(null==(r=null===(t=null===(n=e.detail)||void 0===n?void 0:n.fetchResponse)||void 0===t?void 0:t.contentType)||!Boolean(r.match(/\b(?:java|ecma)script\b/)))return;const a=document.createElement("script"),c=window.mrujs.cspNonce();null!=c&&a.setAttribute("nonce",c),window.mrujs.enableElement(e),null===(i=null===(o=e.detail)||void 0===o?void 0:o.fetchResponse)||void 0===i||i.text().then((n=>{var t,o;a.text=n,null===(o=null===(t=document.head.appendChild(a))||void 0===t?void 0:t.parentNode)||void 0===o||o.removeChild(a);const{element:i,fetchRequest:r,fetchResponse:c}=e.detail;window.mrujs.navigationAdapter.navigate(i,r,c)})).catch((e=>console.error(e)))}function a(){return{name:"MrujsTurbo",initialize:s,connect:d,disconnect:u}}const c="text/vnd.turbo-stream.html";function s(){const e=window.mrujs.mimeTypes.any;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${c}, ${e}`},{shortcut:"turbo",header:c}])}function d(){document.addEventListener("ajax:beforeNavigation",l)}function u(){document.removeEventListener("ajax:beforeNavigation",l)}function l(e){const n=e.detail.fetchResponse;var t;null!=n&&(t=n.contentType,Boolean(t.includes(c))&&(e.preventDefault(),n.html().then((e=>{window.Turbo.renderStreamMessage(e)})).catch((e=>{console.error(e)}))))}function m(){return{name:"Shoelace",connect:h,disconnect:v}}function h(){document.addEventListener("sl-submit",p)}function v(){document.removeEventListener("sl-submit",p)}function p(e){var n,t,o;const i=e.target,r=e.detail.formData,a=i.getAttribute("action");let c=i.getAttribute("method");if(null==a)return void console.warn("No 'action' attribute on your Shoelace form. Aborting...");null==c&&(c="get");const s=()=>window.mrujs;null===(o=null===(t=null===(n=s())||void 0===n?void 0:n.fetch(a,{element:i,dispatchEvents:!0,method:c,body:s().urlEncodeFormData(r)}))||void 0===t?void 0:t.then((()=>{})))||void 0===o||o.catch((e=>console.warn(e)))}export{e as CableCar,n as JsErb,a as MrujsTurbo,m as Shoelace};
//# sourceMappingURL=plugins.module.min.js.map
